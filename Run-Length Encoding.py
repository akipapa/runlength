# -*- coding: utf-8 -*-
"""Untitled21.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1TafCF5e3Jzcxi4-WYSNMJpyOjiG0PifD
"""

import streamlit as st

# ãƒ©ãƒ³ãƒ¬ãƒ³ã‚°ã‚¹åœ§ç¸®ã‚’è¡Œã†é–¢æ•°
def run_length_encoding(input_str):
    encoded_str = ''
    count = 1
    encoded_data = []

    if len(input_str) == 0:
        return encoded_str, encoded_data

    for i in range(1, len(input_str)):
        if input_str[i] == input_str[i - 1]:
            count += 1
        else:
            encoded_str += input_str[i - 1] + str(count)
            encoded_data.append((input_str[i - 1], count))
            count = 1

    encoded_str += input_str[-1] + str(count)
    encoded_data.append((input_str[-1], count))

    return encoded_str, encoded_data

# åœ§ç¸®ç‡ã‚’æ±‚ã‚ã‚‹é–¢æ•°
def calculate_compression_rate(input_str, encoded_str):
    original_size = len(input_str)
    compressed_size = len(encoded_str)
    compression_rate = (1 - compressed_size / original_size) * 100
    return original_size, compressed_size, compression_rate

# Streamlit ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã® UI
# ã‚¿ã‚¤ãƒˆãƒ«
st.header('ğŸ“¦ ãƒ©ãƒ³ãƒ¬ãƒ³ã‚°ã‚¹åœ§ç¸®')

# å…¥åŠ›ä¾‹ã‚’è¿½åŠ 
st.markdown("### ä¾‹: `AAABBBCCCDDD` ã®ã‚ˆã†ã«ã€åŠè§’ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚")

# å…¥åŠ›
input_str = st.text_input('âœï¸ åŠè§’ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:')

if input_str:
    # åœ§ç¸®å‡¦ç†
    encoded_str, encoded_data = run_length_encoding(input_str)
    original_size, compressed_size, compression_rate = calculate_compression_rate(input_str, encoded_str)

    # å…ƒã®ãƒ‡ãƒ¼ã‚¿
    st.header('ğŸ—ƒï¸ å…ƒã®ãƒ‡ãƒ¼ã‚¿')
    st.info(f'å…¥åŠ›ãƒ‡ãƒ¼ã‚¿: **{input_str}**')
    st.write(f'å…ƒã®ãƒ‡ãƒ¼ã‚¿ã®ã‚µã‚¤ã‚º: **{original_size} ãƒã‚¤ãƒˆ**')

    # åœ§ç¸®å¾Œã®ãƒ‡ãƒ¼ã‚¿
    st.header('ğŸ”§ åœ§ç¸®å¾Œã®ãƒ‡ãƒ¼ã‚¿')
    st.success(f'ãƒ©ãƒ³ãƒ¬ãƒ³ã‚°ã‚¹åœ§ç¸®å¾Œã®ãƒ‡ãƒ¼ã‚¿: **{encoded_str}**')
    st.write(f'åœ§ç¸®å¾Œã®ãƒ‡ãƒ¼ã‚¿ã®ã‚µã‚¤ã‚º: **{compressed_size} ãƒã‚¤ãƒˆ**')

    # åœ§ç¸®ç‡
    st.header('ğŸ“‰ åœ§ç¸®ç‡ã®çµæœ')
    st.latex(r'''
    åœ§ç¸®ç‡ = \frac{{\text{{å…ƒã®ã‚µã‚¤ã‚º}} - \text{{åœ§ç¸®å¾Œã®ã‚µã‚¤ã‚º}}}}{{\text{{å…ƒã®ã‚µã‚¤ã‚º}}}} \times 100
    ''')
    st.latex(rf'''
    åœ§ç¸®ç‡ = \frac{{{original_size} - {compressed_size}}}{{{original_size}}} \times 100 = {compression_rate:.2f}\%
    ''')
    st.warning(f'åœ§ç¸®ç‡: **{compression_rate:.2f}%**')

    # åœ§ç¸®å¾Œã®ãƒ‡ãƒ¼ã‚¿è©³ç´°
    st.header('ğŸ” åœ§ç¸®å¾Œã®ãƒ‡ãƒ¼ã‚¿è©³ç´°')
    st.table([{'æ–‡å­—': char, 'å‡ºç¾å›æ•°': count} for char, count in encoded_data])

    # æ³¨æ„äº‹é …
    st.caption('â€» åŠè§’ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆä»¥å¤–ã®å…¥åŠ›ã¯ç„¡è¦–ã•ã‚Œã¾ã™ã€‚')

# å•é¡Œã¨é¸æŠè‚¢
options = {
    "1. ABCDEFGH": "æœ€é©ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ç•°ãªã‚‹æ–‡å­—ãŒå¤šã„ãŸã‚åœ§ç¸®åŠ¹æœã¯ä½ã„ã§ã™ã€‚",
    "2. ABABABAB": "æœ€é©ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ç¹°ã‚Šè¿”ã—ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒã‚ã‚‹ãŒã€é•·ã•ãŒå°‘ãªã„ãŸã‚åœ§ç¸®åŠ¹æœãŒä½ã„ã§ã™ã€‚",
    "3. AAAABBBCCCC": "æœ€é©ãªãƒ‡ãƒ¼ã‚¿ã§ã™ã€‚ç¹°ã‚Šè¿”ã—ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒã‚ã‚‹ã®ã§åœ§ç¸®åŠ¹æœãŒé«˜ã„ã§ã™ã€‚",
    "4. ABCCBAABC": "æœ€é©ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ç¹°ã‚Šè¿”ã—ãŒå°‘ãªãã€åœ§ç¸®åŠ¹æœãŒä½ã„ã§ã™ã€‚"
}

# é¸æŠè‚¢ã‚’è¡¨ç¤º
choice = st.radio(
    "åœ§ç¸®ã«æœ€é©ãªãƒ‡ãƒ¼ã‚¿ã‚’é¸ã‚“ã§ãã ã•ã„",
    list(options.keys())
)

# é€ä¿¡ãƒœã‚¿ãƒ³
submit_button = st.button(label='é€ä¿¡')

# æ­£èª¤åˆ¤å®šã¨è§£èª¬
if submit_button:
    correct_answer = "3. AAAABBBCCCC"
    if choice == correct_answer:
        st.success(f'âœ… æ­£è§£ï¼åœ§ç¸®ã«æœ€é©ãªãƒ‡ãƒ¼ã‚¿ã¯ `{correct_answer}` ã§ã™ã€‚')
    else:
        st.error(f'âŒ ä¸æ­£è§£ï¼æ­£è§£ã¯ `{correct_answer}` ã§ã™ã€‚')

    # è§£èª¬
    st.subheader('ğŸ” è§£èª¬')
    st.write(f"æ­£è§£: `{correct_answer}`")

    st.write("""
    ãƒ©ãƒ³ãƒ¬ãƒ³ã‚°ã‚¹åœ§ç¸®ã¯ã€ãƒ‡ãƒ¼ã‚¿ã«ç¹°ã‚Šè¿”ã—ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒã‚ã‚‹å ´åˆã«éå¸¸ã«åŠ¹æœçš„ã§ã™ã€‚ç‰¹ã«ã€åŒã˜æ–‡å­—ãŒé€£ç¶šã—ã¦ç¾ã‚Œã‚‹å ´åˆã«æœ€é©ã§ã™ã€‚

    - **æœ€é©ãªãƒ‡ãƒ¼ã‚¿**ã¯ã€ç¹°ã‚Šè¿”ã—ã®æ–‡å­—åˆ—ï¼ˆä¾‹ï¼š`AAAABBBCCCC`ï¼‰ã§ã™ã€‚ã“ã®ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿ã¯åœ§ç¸®ã•ã‚Œã‚‹ã‚µã‚¤ã‚ºãŒå°ã•ããªã‚Šã€åœ§ç¸®ç‡ãŒéå¸¸ã«é«˜ããªã‚Šã¾ã™ã€‚
    - **åœ§ç¸®åŠ¹æœãŒä½ã„ãƒ‡ãƒ¼ã‚¿**ã¯ã€ç•°ãªã‚‹æ–‡å­—ãŒå¤šãå«ã¾ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ï¼ˆä¾‹ï¼š`ABABABAB` ã‚„ `ABCCBAABC`ï¼‰ã§ã™ã€‚ã“ã®å ´åˆã€å„æ–‡å­—ãŒå€‹åˆ¥ã«ç¾ã‚Œã‚‹ãŸã‚ã€åœ§ç¸®ç‡ã¯ä½ããªã‚Šã¾ã™ã€‚
    """)